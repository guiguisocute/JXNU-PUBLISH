import fs from 'node:fs/promises';
import path from 'node:path';
import matter from 'gray-matter';

const ROOT = process.cwd();
const CARD_DIR = path.join(ROOT, 'content', 'card');

const REWRITE = {
  '20251002-ai-001': {
    title: '新生杯辩论赛报名与材料提交通知',
    description: '面向25级征集新生杯辩论赛参赛同学，请按要求填写报名表并在截止时间前发送至指定邮箱，逾期将不再受理。',
  },
  '20251009-ai-001': {
    title: '赣青二课转专业操作与注意事项',
    description: '发布赣青二课系统转专业流程说明，涉及班级或专业变动的同学需按步骤完成信息调整，避免后续成绩认定与活动申报受影响。',
  },
  '20251009-ai-002': {
    title: '精神卫生日鼓圈体验活动邀请',
    description: '学院发布“鼓动心弦 愈见美好”鼓圈体验活动通知，欢迎心理委员、心协干部及感兴趣同学参与，活动支持二课绩点认定。',
  },
  '20251009-ai-003': {
    title: '第二课堂成绩单制度学习指引',
    description: '面向25级发布第二课堂制度学习通知，覆盖活动分类、认定标准、系统注册与申报流程，请同学按指引尽快完成基础学习。',
  },
  '20251009-ai-004': {
    title: '国防教育法宣讲与模拟法庭观众招募',
    description: '政法学院面向全校开放法律宣讲与模拟法庭活动报名，请按对应表单填写并及时入群；名额确认将依据报名先后顺序执行。',
  },
  '20251010-ai-001': {
    title: '25级心理委员工作联络群入群通知',
    description: '为保障后续心理工作协调与活动组织，通知25级各班心理委员尽快加入指定联络群，重要事项将统一在群内发布。',
  },
  '20251010-ai-002': {
    title: '24级赣青二课转专业截止提醒',
    description: '面向24级需办理赣青二课转专业的同学发布时间提醒，请在截止前完成系统提交，逾期后校级审核渠道将关闭。',
  },
  '20251010-ai-003': {
    title: '25级赣青二课账号开通与完善通知',
    description: '新生赣青二课账号已完成导入，请同学使用初始账号密码登录并及时补全个人信息，信息填写错误会影响后续系统使用。',
  },
  '20251010-ai-004': {
    title: '《侧耳倾听》第十季征音征稿通知',
    description: '大学生党员服务站面向全校征集《侧耳倾听》第十季音频与文稿作品，请按投稿命名与材料要求提交至指定邮箱并入群。',
  },
  '20251014-ai-001': {
    title: '“重young国风”主题活动节目征集',
    description: '艺术团启动“重young国风”主题活动节目预征集，支持多类型创意表演形式，请按通知要求提交报名信息与初审材料。',
  },
  '20251014-ai-002': {
    title: '青春红丝带健康科普大赛参赛通知',
    description: '转发南昌市“青春红丝带”健康科普大赛通知，鼓励有意向团队按赛事规范准备作品并在截止前提交至指定邮箱。',
  },
  '20251014-ai-003': {
    title: '校级优秀志愿服务项目遴选申报通知',
    description: '学院发布校级优秀志愿服务项目储备遴选安排，符合条件的团队可依据通知标准准备申报材料并按要求报送。',
  },
  '20251014-ai-004': {
    title: '校学代会学院代表推选报名通知',
    description: '学院启动第三十三次学生代表大会代表推选，面向23至25级组织报名与材料提交，请各班按代表条件和时间节点落实。',
  },
  '20251014-ai-005': {
    title: '校级学生提案征集与提交通知',
    description: '学院开展学生提案征集，提案需包含问题名称、依据与具体建议，请按格式要求在规定时间前完成电子与纸质材料提交。',
  },
  '20251015-ai-001': {
    title: '院十佳歌手大赛海选报名通知',
    description: '学院发布“智声无界，音你闪耀”十佳歌手海选报名安排，请参赛同学在截止前提交报名表与伴奏文件并及时进群对接。',
  },
  '20251020-ai-001': {
    title: '院十佳歌手复决赛门票领取通知',
    description: '院十佳歌手复决赛将按通知时间举行，现面向各年级发放观赛门票，请有意观赛同学在规定时段到指定地点领取。',
  },
  '20251020-ai-002': {
    title: '校园十佳歌手大赛报名与海选安排',
    description: '第三十六届校园十佳歌手大赛开放报名，通知明确了报名时间、海选时间地点及参赛条件，请有意同学按要求参与。',
  },
  '20251021-ai-001': {
    title: '校运会看台座位与集合安排通知',
    description: '学院公布校运会看台座位分布、集合地点与进退场要求，请24和25级班委组织同学按时到位并配合现场秩序管理。',
  },
  '20251021-ai-002': {
    title: '学院志愿者招募群建立通知',
    description: '为提升志愿活动组织效率，学院建立统一志愿者招募群，请班委转发群信息并动员同学按需入群，后续招募统一发布。',
  },
  '20251021-ai-003': {
    title: '“抗美援朝烽火忆”主题活动报名通知',
    description: '党员服务站学术部将举办抗美援朝主题活动，面向25级开放报名并设置思想成长类绩点，请按时间要求完成入群与登记。',
  },
  '20251022-ai-001': {
    title: '校运会看台安排补充提醒',
    description: '对校运会看台观赛时段、集合要求与负责人联络方式进行补充，请相关班级再次核对并按通知执行。',
  },
  '20251024-ai-001': {
    title: '数字化转型培训名额分配与提报通知',
    description: '学院争取到第三期制造业数字化转型培训名额，23与24级需按班级完成分组并提交名单，请在截止前统一上报。',
  },
  '20251025-ai-001': {
    title: '合唱比赛成员招募通知',
    description: '学院发布大中小合唱比赛招募信息，面向有基础音准与音乐兴趣的同学开放报名，请按通知方式进群并参与后续排练。',
  },
  '20251027-ai-001': {
    title: '第二课堂新制度学生骨干培训通知',
    description: '院团委二课将面向学生组织负责人和团支书开展新制度培训，请相关负责人按时参会并做好班级传达与落地。',
  },
  '20251027-ai-002': {
    title: '25级赣青二课账号异常反馈通知',
    description: '针对新生账号登录异常与信息错误问题，通知各班汇总异常同学信息后统一上报，学院将集中处理账号校正。',
  },
  '20251027-ai-003': {
    title: '挑战杯专项赛模拟答辩观摩通知',
    description: '校团委将开展挑战杯“人工智能+”专项赛模拟答辩，欢迎感兴趣同学到场观摩，了解答辩流程与项目展示要点。',
  },
  '20251028-ai-001': {
    title: '25级班级二课培训与材料提交通知',
    description: '要求25级各班团支书组织第二课堂制度培训，并在截止前提交培训照片和命名规范材料，确保政策覆盖到班。',
  },
  '20251028-ai-002': {
    title: '图书馆接待日意见建议征集通知',
    description: '图书馆面向全体同学征集馆藏、借阅、空间与设施服务建议，请按收集表提交有效反馈，助力后续服务优化。',
  },
  '20251029-ai-001': {
    title: '25级二课答疑群入群提醒',
    description: '请25级班长和团支书尽快加入二课答疑群，后续账号问题、规则咨询与系统操作答疑将统一在群内处理。',
  },
};

const run = async () => {
  for (const [id, meta] of Object.entries(REWRITE)) {
    const filePath = path.join(CARD_DIR, `${id}.md`);
    const raw = await fs.readFile(filePath, 'utf8');
    const parsed = matter(raw);
    parsed.data.title = meta.title;
    parsed.data.description = meta.description;
    const next = matter.stringify(parsed.content.trim() + '\n', parsed.data, { lineWidth: 10000 });
    await fs.writeFile(filePath, next, 'utf8');
  }
  console.log(`Refined v2 copywriting for ${Object.keys(REWRITE).length} October cards.`);
};

run().catch((error) => {
  console.error(error.message);
  process.exit(1);
});
