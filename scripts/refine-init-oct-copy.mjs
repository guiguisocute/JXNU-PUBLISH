import fs from 'node:fs/promises';
import path from 'node:path';
import matter from 'gray-matter';

const ROOT = process.cwd();
const CARD_DIR = path.join(ROOT, 'content', 'card');

const REWRITE = {
  '20251002-ai-001': {
    title: '新生杯辩论赛报名通知',
    description: '面向25级同学征集新生杯辩论赛参赛选手，请按要求填写报名表并在规定时间前提交至指定邮箱，逾期不再受理。',
    category: '竞赛相关',
    tags: ['辩论赛', '新生杯', '报名通知', '25级']
  },
  '20251009-ai-001': {
    title: '赣青二课转专业操作说明',
    description: '发布赣青二课系统“转专业/转班级”办理步骤与注意事项，涉及班级变动同学需按流程尽快完成信息调整，避免后续二课认定受影响。',
    category: '问卷填表',
    tags: ['赣青二课', '转专业办理', '系统操作', '信息更新']
  },
  '20251009-ai-002': {
    title: '精神卫生日鼓圈体验活动邀请',
    description: '学院发布“鼓动心弦 愈见美好”鼓圈体验活动通知，欢迎心理委员、心协干部及感兴趣同学参与，活动可在赣青二课查看绩点信息。',
    category: '二课活动',
    tags: ['心理健康', '鼓圈活动', '精神卫生日', '二课活动']
  },
  '20251009-ai-003': {
    title: '第二课堂成绩单制度学习指引',
    description: '面向25级发布第二课堂成绩单制度学习通知，包含活动分类认定、系统注册登录与申报流程，请新生按指引完成学习并规范使用系统。',
    category: '问卷填表',
    tags: ['第二课堂', '新生培训', '制度解读', '系统使用']
  },
  '20251010-ai-001': {
    title: '25级心理委员联络群入群通知',
    description: '为保障心理工作联动与信息传达，通知25级各班心理委员尽快加入指定联络群，后续心理活动组织与通知将统一在群内发布。',
    category: '通知公告',
    tags: ['心理委员', '群组通知', '班委工作', '25级']
  },
  '20251010-ai-002': {
    title: '赣青二课转专业截止时间提醒',
    description: '面向24级需在赣青二课系统办理转专业的同学发布截止提醒，校级审核将在指定时间后停止受理，请尽快完成提交。',
    category: '问卷填表',
    tags: ['赣青二课', '转专业办理', '截止提醒', '24级']
  },
  '20251010-ai-003': {
    title: '新生二课账号开通与征稿通知',
    description: '新生赣青二课账号已完成导入，请按初始账号密码登录并及时修改，同时关注《侧耳倾听》栏目征音征稿安排，按要求参与投稿。',
    category: '通知公告',
    tags: ['赣青二课', '账号开通', '征稿征音', '新生通知']
  },
  '20251014-ai-001': {
    title: '“重young国风”主题活动节目征集',
    description: '艺术团启动“重young国风”主题活动节目预征集，支持多类型创意表演形式，报名与视频材料请按通知要求在截止时间前提交。',
    category: '二课活动',
    tags: ['国风活动', '节目征集', '校园文化', '报名通知']
  },
  '20251014-ai-002': {
    title: '青春红丝带健康科普大赛征集通知',
    description: '转发南昌市“青春红丝带”健康科普大赛通知，鼓励有意向团队按赛事要求准备作品并在截止日期前报送，学院同步接受咨询。',
    category: '竞赛相关',
    tags: ['青春红丝带', '健康科普', '作品征集', '团队参赛']
  },
  '20251014-ai-003': {
    title: '校级优秀志愿服务项目遴选通知',
    description: '学院发布校级优秀志愿服务项目储备遴选通知，符合条件的团队可结合项目实际准备申报材料并按要求提交。',
    category: '志愿实习',
    tags: ['志愿服务', '项目遴选', '项目申报', '青协']
  },
  '20251014-ai-004': {
    title: '校学代会学院代表候选人提名通知',
    description: '学院启动第三十三次学生代表大会代表推选工作，面向23-25级按程序开展民主提名，请各班按代表条件与时间节点组织落实。',
    category: '通知公告',
    tags: ['学代会', '代表选举', '民主提名', '班委通知']
  },
  '20251014-ai-005': {
    title: '校级学生提案征集活动通知',
    description: '学院通知开展学校提案征集，围绕学业发展、生涯规划与校园服务等方向提交规范提案，请各班积极动员同学参与建言。',
    category: '通知公告',
    tags: ['提案征集', '学生权益', '校园治理', '建言反馈']
  },
  '20251015-ai-001': {
    title: '院十佳歌手大赛海选报名通知',
    description: '学院发布2025年院十佳歌手大赛报名通知，欢迎同学报名参加海选，展示舞台表现力与音乐风采。',
    category: '竞赛相关',
    tags: ['十佳歌手', '海选报名', '校园文化', '文艺赛事']
  },
  '20251020-ai-001': {
    title: '院十佳歌手复决赛观赛门票领取通知',
    description: '院十佳歌手复决赛将按通知时间举行，现面向各年级发放观赛门票，请有意观赛同学按指定时段领取并按时入场。',
    category: '二课活动',
    tags: ['十佳歌手', '观赛门票', '活动入场', '校园文化']
  },
  '20251020-ai-002': {
    title: '校园十佳歌手大赛报名与海选安排',
    description: '发布第三十六届校园十佳歌手大赛报名、海选时间地点及参赛要求，请有意参赛同学在规定时段内完成报名并参加海选。',
    category: '竞赛相关',
    tags: ['校园十佳歌手', '报名通知', '海选安排', '文艺竞赛']
  },
  '20251021-ai-001': {
    title: '校运会看台座位与进退场安排通知',
    description: '学院公布校运会期间各班看台座位与集合进场安排，请24、25级按统一时间组织到位并配合现场秩序管理与口号助威。',
    category: '通知公告',
    tags: ['校运会', '看台安排', '班级组织', '进退场通知']
  },
  '20251021-ai-002': {
    title: '学院志愿者招募群建立通知',
    description: '为提升志愿活动组织效率，学院建立统一志愿者招募群，请班委转发群信息并动员同学按需入群，后续招募将统一发布。',
    category: '志愿实习',
    tags: ['志愿服务', '招募群', '信息发布', '青协通知']
  },
  '20251022-ai-001': {
    title: '校运会看台安排补充提醒',
    description: '对校运会看台分布与观赛时段进行补充说明，请相关班级再次核对时间与位置安排，确保按要求完成集合与离场。',
    category: '通知公告',
    tags: ['校运会', '看台补充', '时间提醒', '班委通知']
  },
  '20251024-ai-001': {
    title: '制造业数字化转型培训报名通知',
    description: '学院发布第三期制造业数字化转型培训名额通知，24级与23级需按班级完成人员推荐并提交名单，逾期将影响统一上报。',
    category: '通知公告',
    tags: ['数字化转型', '培训通知', '名单上报', '23-24级']
  },
  '20251025-ai-001': {
    title: '合唱比赛成员招募通知',
    description: '学院启动大中小合唱比赛队员招募，面向有基本音准与音乐兴趣的同学开放报名，请按通知方式入群并完成后续对接。',
    category: '二课活动',
    tags: ['合唱比赛', '成员招募', '校园文化', '报名通知']
  },
  '20251027-ai-001': {
    title: '第二课堂新制度学生骨干培训通知',
    description: '院团委二课面向学生组织负责人和团支书开展第二课堂新制度与新系统培训，要求相关负责人按时参训并做好班级传达。',
    category: '问卷填表',
    tags: ['第二课堂', '制度培训', '学生组织', '团支书']
  },
  '20251027-ai-002': {
    title: '25级赣青二课账号异常信息反馈通知',
    description: '针对新生账号登录异常问题，通知各班汇总异常同学信息并按模板提交，学院将集中处理账号与班级信息校正。',
    category: '问卷填表',
    tags: ['赣青二课', '账号异常', '信息反馈', '25级']
  },
  '20251027-ai-003': {
    title: '挑战杯专项赛模拟答辩观摩通知',
    description: '校团委将开展挑战杯“人工智能+”专项赛模拟答辩，欢迎有兴趣同学到场观摩学习，了解答辩流程与项目展示方式。',
    category: '竞赛相关',
    tags: ['挑战杯', '模拟答辩', '项目观摩', '学习交流']
  },
  '20251028-ai-001': {
    title: '25级班级二课制度培训材料提交通知',
    description: '要求25级各班团支书组织班级开展第二课堂制度培训，并在截止前提交培训照片与佐证材料，确保政策覆盖到班。',
    category: '问卷填表',
    tags: ['第二课堂', '班级培训', '材料提交', '25级']
  },
  '20251028-ai-002': {
    title: '图书馆接待日意见建议征集通知',
    description: '为优化图书馆服务质量，现面向全体同学征集馆藏、借阅、空间与设施等方面建议，请按收集表提交真实反馈。',
    category: '问卷填表',
    tags: ['图书馆服务', '意见征集', '问卷反馈', '校园服务']
  },
  '20251029-ai-001': {
    title: '25级二课答疑群入群通知',
    description: '请25级班长与团支书尽快加入二课答疑群，后续账号问题、规则咨询与操作答疑将统一在群内处理。',
    category: '通知公告',
    tags: ['赣青二课', '答疑群', '班长团支书', '25级']
  }
};

const run = async () => {
  const ids = Object.keys(REWRITE);
  for (const id of ids) {
    const filePath = path.join(CARD_DIR, `${id}.md`);
    const raw = await fs.readFile(filePath, 'utf8');
    const parsed = matter(raw);
    parsed.data.title = REWRITE[id].title;
    parsed.data.description = REWRITE[id].description;
    parsed.data.category = REWRITE[id].category;
    parsed.data.tags = REWRITE[id].tags;
    const next = matter.stringify(parsed.content.trim() + '\n', parsed.data, { lineWidth: 10000 });
    await fs.writeFile(filePath, next, 'utf8');
  }
  console.log(`Refined copywriting for ${ids.length} October cards.`);
};

run().catch((error) => {
  console.error(error.message);
  process.exit(1);
});
