# 开发需求澄清（v1）

更新时间：2026-02-08

说明：本文按 v2 -> v5 记录需求演进，出现冲突时以最新版本结论（v5）为准。

## v2 冻结结论（本轮对话更新）

- 详情不走独立路由：通知详情在列表页内通过“卡片放大居中”交互呈现。
- 学院不做独立 URL：仅首页筛选。
- 内容模型从三层收敛为两层：`origin + card`，`post` 废弃。
- 三层/两层关联主键采用显式 `id`（frontmatter 字段），不靠文件名隐式绑定。
- 置顶作用域为“分类内置顶”。
- 搜索采用 C 路线：先单索引（标题+正文），后续按学院拆分索引。
- 附件 URL 采用 C 路线：同时支持仓库相对路径和外链绝对 URL。
- 构建映射链路采用 A：`scripts/` 生成静态产物到 `generated/`，前端直接消费。

## v3 冻结结论（补充更新）

- 学院入口改为支持独立 URL（`/school/:slug`），首页筛选仍保留。
- 详情层打开时不改 URL（保持当前页面地址）。
- 详情层内需要支持“上一条/下一条”切换。
- 详情正文来源冻结为 `card` 层正文（不是 `origin` 回填）。
- 搜索交互采用双态：先下拉建议，结果过多再进入 `/search` 面板页。
- `generated/` 产物需要同时输出 `.json` 与 `.ts` 两套。

## v4 冻结结论（补充更新）

- 学院 slug 采用英文短码（如 `csie`）。
- 学院页采用“首页同构 + 默认筛选”方案。
- 搜索策略改为“同页实时过滤”，不再新增 `/search` 页面。
- 详情正文继续由 `card` 层承载，格式使用 Markdown。
- `origin` 层继续保留正文（用于存档追溯）。
- 详情页/弹层中，附件区需要独立 UI，并优先置于正文前，便于直接下载。
- 详情“上一条/下一条”顺序依据当前列表顺序。
- 置顶冲突规则：置顶优先，时间次之。
- 已读状态需要本地持久化。

## v5 冻结结论（补充更新）

- `generated` 产物命名采用固定文件名（不加版本后缀）。
- 下一阶段交付两份可开工任务拆解文档：
  - `plan/开发任务分解-数据编译.md`
  - `plan/开发任务分解-前端重构.md`

## 1) 已确认目标

- 项目定位：校园通知展示站，纯静态网站。
- 不做后端服务：内容由智能 Agent 生成/整理后，通过 webhook 推送到仓库，定时重构部署。
- 核心目标：打破全校信息差，面向全体学生。
- 移动端优先级：与桌面同权，双端都要打磨。
- 上线方式：静态托管（由你自己的云服务器+自动部署流程完成）。
- 内容规模：全校学院合计日新增通常不超过 100 条。
- 当前分类与卡片优先级：先沿用现状，后续再迭代。
- 标签策略：由内容管理 Agent 写死（人工/规则可混合，但当前按“写死”执行）。

## 2) 当前架构方向（已达成共识）

- 当前“单域名单页承载全部内容”的结构要拆分。
- 仪表盘拆为独立页面（`/dashboard`）。
- 通知详情不走新页面路由，在列表页内弹出/放大展示。
- 需要按“页面职责”拆分，而不是把所有功能堆在一个 `App.tsx` 里。

## 3) `content/` 目录现状（已检查）

目前存在：

- `content/origin/example.md`：原始通知正文 + 附件引用。
- `content/post/test1.md`：旧草案，后续计划废弃。
- `content/card/test1.md`：卡片层目录已预留。
- `content/origin/attachments/*`：附件文件（pdf/docx）。

结论更新：内容模型收敛为“原文层（origin）+ 展示层（card）”。

## 4) 现阶段优先事项

1. 先定内容模型（字段、目录、命名规则），再做页面拆分。
2. 先定 URL 结构（路由），再决定组件边界。
3. 先定“发布流水线输入输出”，再做 webhook 自动化。

## 5) 已关闭问题（追溯）

- 已关闭：是否需要 `/notice/:id` 独立详情路由。
  - 结论：不需要，详情在列表页内打开。
- 已关闭：是否需要学院独立 URL。
  - 结论：需要，采用 `/school/:slug`。
- 已关闭：`origin/post/card` 是否三层并存。
  - 结论：`post` 废弃，保留 `origin + card`。
- 已关闭：搜索是否需要 `/search` 页面。
  - 结论：不需要，采用同页实时过滤。

## 6) 接下来执行顺序（提案）

1. 完成 v2 需求问答，冻结信息架构。
2. 输出 `plan/信息架构与路由设计.md`。
3. 输出 `plan/content-数据规范.md`（含 frontmatter 字段标准）。
4. 再进入代码重构（路由拆分 + 页面拆分 + 动效落地）。
