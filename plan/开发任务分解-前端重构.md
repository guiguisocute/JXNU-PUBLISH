# 开发任务分解：前端重构（页面拆分 + 详情动效 + 附件优先）

更新时间：2026-02-08

## 0. 目标

- 从单体 `App.tsx` 拆分页面职责。
- 落地“同页卡片放大居中详情”交互（不改 URL）。
- 学院页路由化（`/school/:slug`），但布局与首页同构。
- 详情中附件区独立且位于正文前。

## 1. 任务拆解

### 1.1 路由层拆分

- 新增页面：
  - `pages/HomePage.tsx`
  - `pages/SchoolPage.tsx`
  - `pages/DashboardPage.tsx`
- 路由规则：
  - `/`
  - `/school/:slug`
  - `/dashboard`
- 详情不新增路由，仅由页面状态控制弹层。

### 1.2 数据接入改造

- 从 `generated/content-data` 读取列表和详情数据。
- 首页与学院页共用列表渲染容器：
  - 首页显示全部
  - 学院页按 `slug` 预筛选

### 1.3 卡片与详情交互

- `components/NoticeCard.tsx`（原 `PostCard`）
  - 点击触发 `activeNoticeId`
  - 保留当前分类/分页/滚动状态
- `components/NoticeDetailModal.tsx`（原 `PostDetailModal`）
  - 居中弹层 + 背景遮罩 + ESC/遮罩关闭
  - 详情打开/关闭过渡动效
  - 支持上一条/下一条（按当前列表顺序）

命名统一要求：前端新增命名优先使用 `Notice*`，避免与已废弃的 `post` 层概念混淆。

### 1.4 详情内容结构

- 区块顺序固定：
  1) 标签/来源头部
  2) 标题
  3) 附件下载区（独立 UI）
  4) 正文内容（Markdown）
  5) 底部时间与操作

附件区 UI 最小要求：

- 文件名
- 文件类型/扩展名
- 下载按钮

### 1.5 搜索交互

- 采用同页实时过滤（无 `/search`）。
- 输入即过滤：标题 + 正文。
- 大结果量仍在当前页展示（可后续增加“查看更多”折叠）。

### 1.6 已读状态持久化

- 使用 localStorage（或沿用 IndexedDB）保存已读 id 集合。
- 进入详情即标记已读。
- 刷新页面后已读样式保持。

## 2. 排序与置顶

- 分类内置顶优先（`pinned=true`）。
- 然后按 `published` 降序。
- 再按 `id` 做稳定排序。

## 3. 验收标准

- 首页/学院页都可正常打开详情（不改 URL）。
- 详情内上一条/下一条按当前列表顺序切换。
- 附件区在正文前展示且可下载。
- 搜索实时过滤在移动端和桌面端表现一致。
- 已读状态刷新后仍保留。

## 4. 推荐实施顺序

1. 路由拆分（Home/School/Dashboard）
2. 数据接入切到 `generated/`
3. 详情弹层与动效
4. 附件区独立 UI
5. 搜索实时过滤
6. 已读持久化与回归测试
